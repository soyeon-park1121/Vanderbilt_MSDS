"0","# Make a subset for non-smoking group's birthweight"
"0","bwt.non.smoker <- bwt %>% filter(smoke == 0) %>% "
"0","  filter(!is.na(bwt)) %>% `[[`(""bwt"")"
"0",""
"0","# Simulation"
"0","R <- 5000 # The number of simulation"
"0","mu.s <- rep(NA, R)"
"0","mu.ns <- rep(NA, R)"
"0","result <- rep(NA, R)"
"0",""
"0","# MLE for smoker group"
"0","mean.mle_mu.s <- mean(bwt.smoker)"
"0","sd.mle_mu.s <- sd(bwt.smoker)"
"0",""
"0","# MLE for non-smoker group"
"0","mean.mle_mu.ns <- mean(bwt.non.smoker)"
"0","sd.mle_mu.ns <- sd(bwt.non.smoker)"
"0",""
"0","for(i in 1:R) {"
"0","  s <- rnorm(length(bwt.smoker), mean = mean.mle_mu.s, sd = sd.mle_mu.s)"
"0","  mu.s[i] <- mean(s)"
"0","  ns <- rnorm(length(bwt.non.smoker), mean = mean.mle_mu.ns, sd = sd.mle_mu.ns)"
"0","  mu.ns[i] <- mean(ns)"
"0","  result[i] <- mu.s[i]/mu.ns[i]"
"0","}"
"0",""
"0","quantile(result, c(0.025, 0.975))"
"1","     2.5% "
"1","    97.5% "
"1","
"
"1","0.8457679 "
"1","0.9732990 "
"1","
"
