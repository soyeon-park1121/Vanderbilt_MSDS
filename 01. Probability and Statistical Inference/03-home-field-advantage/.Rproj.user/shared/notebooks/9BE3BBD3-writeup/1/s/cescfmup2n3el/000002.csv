"0","simulation_ws <- function(hfi = c(0, 0, 1, 1, 1, 0, 0), adv_multi = 1.1, pb = 0.55) {"
"0","  pbh <- 0.55 * adv_multi"
"0","  pba <- 1 - (1 -0.55) * adv_multi"
"0","  "
"0","  win_count = 0"
"0","  "
"0","  for(i in 1:7) {"
"0","    if(hfi[i]) {"
"0","      p_win = pbh"
"0","    } else {"
"0","      p_win = pba"
"0","    }"
"0","    game_out = rbinom(1, 1, p_win)"
"0","    win_count = win_count + game_out"
"0","    "
"0","    if(win_count == 4 | (1 - win_count) == 4) break"
"0","  }"
"0","  return(win_count == 4)"
"0","}"
