"0","# x-axis = prob_braves, y-axis = diff"
"0","prob_braves <- seq(0, 1, by = 0.01)"
"0","diff <- NA"
"0",""
"0","for(i in 1 : length(prob_braves)) {"
"0","# Calculating the probability that the Braves win the World Series with the advantage factor 1.1"
"0","  ws_adv <- function(pb = prob_braves[i]) {"
"0","    hfi = c(0, 0, 1, 1, 1, 0, 0)"
"0","    pbh <- pb * 1.1"
"0","    pba <- 1 - (1 - pb) * 1.1"
"0","    "
"0","    apo[, p := NA_real_]"
"0","    for(i in 1:nrow(apo)) {"
"0","      prob_game <- rep(1, 7)"
"0","      for (j in 1:7) {"
"0","        p_win <- ifelse(hfi[j], pbh, pba)"
"0","        prob_game[j] <- case_when("
"0","          apo[i, j, with = FALSE] == ""W"" ~ p_win,"
"0","          apo[i, j, with = FALSE] == ""L"" ~ 1 - p_win,"
"0","          TRUE ~ 1"
"0","      )"
"0","    }"
"0","   apo[i, p := prod(prob_game)]"
"0","  }"
"0","  apo[, sum(p), overall_outcome]$V1[1]"
"0","  }"
"0","  "
"0","# Calculating the probability that the Braves win the World Series without the advantage factor"
"0","  ws_no_adv <- function(pb = prob_braves[i]) {"
"0","    hfi = c(0, 0, 1, 1, 1, 0, 0)"
"0","    pbh <- pb * 1"
"0","    pba <- 1 - (1 - pb) * 1"
"0","    "
"0","    apo[, p := NA_real_]"
"0","    for(i in 1:nrow(apo)) {"
"0","      prob_game <- rep(1, 7)"
"0","      for (j in 1:7) {"
"0","        p_win <- ifelse(hfi[j], pbh, pba)"
"0","        prob_game[j] <- case_when("
"0","          apo[i, j, with = FALSE] == ""W"" ~ p_win,"
"0","          apo[i, j, with = FALSE] == ""L"" ~ 1 - p_win,"
"0","          TRUE ~ 1"
"0","        )"
"0","    }"
"0","   apo[i, p := prod(prob_game)]"
"0","  }"
"0","  apo[, sum(p), overall_outcome]$V1[1]"
"0","  }"
"0",""
"0","#Calculating difference between in the probability with and witout the advantage factor & Assigning the result in the ""diff"" vector."
"0","diff[i] <- ws_no_adv(pb = prob_braves[i]) - ws_adv(pb = prob_braves[i])"
"0","}"
"2","
"
