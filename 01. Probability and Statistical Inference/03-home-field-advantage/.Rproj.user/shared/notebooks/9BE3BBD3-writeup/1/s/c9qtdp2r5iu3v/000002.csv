"0","# x-axis = adv_factor, y-axis = diff"
"0","adv_factor <- seq(1, 2, by = 0.01)"
"0","diff <- NA"
"0",""
"0","for(i in 1 : length(adv_factor)) {"
"0","  ws_adv <- function(multi_advantage = adv_factor[i]) {"
"0","    hfi = c(0, 0, 1, 1, 1, 0, 0)"
"0","    pbh <- 0.55 * multi_advantage"
"0","    pba <- 1 - (1 - 0.55) * multi_advantage"
"0","    "
"0","    apo[, p := NA_real_]"
"0","    for(i in 1:nrow(apo)) {"
"0","      prob_game <- rep(1, 7)"
"0","      for (j in 1:7) {"
"0","        p_win <- ifelse(hfi[j], pbh, pba)"
"0","        prob_game[j] <- case_when("
"0","          apo[i, j, with = FALSE] == ""W"" ~ p_win,"
"0","          apo[i, j, with = FALSE] == ""L"" ~ 1 - p_win,"
"0","          TRUE ~ 1"
"0","      )"
"0","    }"
"0","   apo[i, p := prod(prob_game)]"
"0","  }"
"0","  apo[, sum(p), overall_outcome]$V1[1]"
"0","  }"
"0",""
"0","  ws_no_adv <- function(multi_advantage = adv_factor[i]) {"
"0","    hfi = c(0, 0, 1, 1, 1, 0, 0)"
"0","    pbh <- 0.55 * 1"
"0","    pba <- 1 - (1 - 0.55) * 1"
"0","    "
"0","    apo[, p := NA_real_]"
"0","    for(i in 1:nrow(apo)) {"
"0","      prob_game <- rep(1, 7)"
"0","      for (j in 1:7) {"
"0","        p_win <- ifelse(hfi[j], pbh, pba)"
"0","        prob_game[j] <- case_when("
"0","          apo[i, j, with = FALSE] == ""W"" ~ p_win,"
"0","          apo[i, j, with = FALSE] == ""L"" ~ 1 - p_win,"
"0","          TRUE ~ 1"
"0","        )"
"0","    }"
"0","   apo[i, p := prod(prob_game)]"
"0","  }"
"0","  apo[, sum(p), overall_outcome]$V1[1]"
"0","  }"
"0","diff[i] <- ws_no_adv(multi_advantage = adv_factor[i]) - ws_adv(multi_advantage = adv_factor[i])"
"0","}"
"0","plot(adv_factor, diff, type = ""l"", main = ""with VS without home field advantage"", xlab = ""The advantage factor"", ylab = ""The difference in probabilities(with vs without holme field advantage"")"
