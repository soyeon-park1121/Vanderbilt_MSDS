"0","analytic_ws <- function(hfi = c(0, 0, 1, 1, 1, 0, 0), adv_multi = 1.1, pb = 0.55) { #hfi = home field indicator"
"0","  pbh <- pb * adv_multi"
"0","  pba <- 1 - (1 - pb) * adv_multi"
"0","  apo[, p := NA_real_]"
"0","  "
"0","  for(i in 1:nrow(apo)) {"
"0","    prob_game <- rep(1, 7)"
"0","    for (j in 1:7) {"
"0","      p_win <- ifelse(hfi[j], pbh, pba)"
"0","      prob_game[j] <- case_when("
"0","        apo[i, j, with = FALSE] == ""W"" ~ p_win,"
"0","        apo[i, j, with = FALSE] == ""L"" ~ 1 - p_win,"
"0","        TRUE ~ 1"
"0","      )"
"0","    }"
"0","   apo[i, p := prod(prob_game)]"
"0","  }"
"0","  apo[, sum(p), overall_outcome]"
"0","}"
"0",""
"0","final <- merge(analytic_ws(), analytic_ws(adv_multi = 1), by = ""overall_outcome"")"
"0","names(final)[names(final) == ""V1.x""] <- ""w/ home field advantage"""
"0","names(final)[names(final) == ""V1.y""] <- ""w/o home field advantage"""
"0","final[2,]"
